"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7929],{7929:(j,b,s)=>{s.r(b),s.d(b,{Tab2PageModule:()=>A});var i=s(9843),u=s(6814),h=s(95),e=s(9468);let x=(()=>{var n;class a{}return(n=a).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.ez,h.u5,i.Pc]}),a})(),M=(()=>{var n;class a{}return(n=a).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.ez,h.u5,i.Pc]}),a})();var C=s(2881),d=s(5861),S=s(7838),T=s(2616),P=s(7024),y=s(5517),Z=s(7830),O=s(7519),E=s(4734),w=s(2377);function I(n,a){1&n&&e._UZ(0,"ion-icon",7)}function F(n,a){if(1&n){const r=e.EpF();e.TgZ(0,"ion-item",1),e.NdJ("click",function(){e.CHM(r);const t=e.oxw();return e.KtG(t.goToEnviarParametro(t.eventosae.id))}),e._UZ(1,"div",2),e.TgZ(2,"ion-label",3)(3,"h2"),e._uU(4),e.TgZ(5,"span",4)(6,"ion-note",5),e._uU(7),e.qZA(),e.YNc(8,I,1,0,"ion-icon",6),e.qZA()(),e.TgZ(9,"p"),e._uU(10),e.qZA()()()}if(2&n){const r=e.oxw();e.Q6J("detail",!0),e.xp6(1),e.Tol(0===r.eventosae.estadoEnvio?"dot dot-active":"dot dot-unread"),e.xp6(3),e.hij(" ",r.eventosae.numero_ot," "),e.xp6(3),e.Oqu(r.formatearFecha(r.eventosae.fecha_hora_ejecucion)),e.xp6(1),e.Q6J("ngIf",r.isIos()),e.xp6(2),e.hij(" ",r.eventosae.requerimiento," ")}}let D=(()=>{var n;class a{isIos(){return this.platform.is("ios")}constructor(o){this.sharedService=o,this.platform=(0,e.f3M)(i.t4)}ngOnInit(){}formatearFecha(o){return(0,w.Z)(o,"dd/MM/yyyy HH:mm")}goToEnviarParametro(o){this.sharedService.selectEventosae(o)}}return(n=a).\u0275fac=function(o){return new(o||n)(e.Y36(E.F))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-evento-sae"]],inputs:{eventosae:"eventosae"},decls:1,vars:1,consts:[[3,"detail","click",4,"ngIf"],[3,"detail","click"],["slot","start"],[1,"ion-text-wrap"],[1,"date"],[1,"small-font"],["aria-hidden","true","name","chevron-forward","size","small",4,"ngIf"],["aria-hidden","true","name","chevron-forward","size","small"]],template:function(o,t){1&o&&e.YNc(0,F,11,7,"ion-item",0),2&o&&e.Q6J("ngIf",t.eventosae)},dependencies:[u.O5,i.gu,i.Ie,i.Q$,i.uN],styles:['@charset "UTF-8";ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0}ion-label[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:12px}ion-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:600;margin:0;color:#191970}ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:95%}ion-item[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{float:right;align-items:center;display:flex}ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:#c9c9ca}ion-item[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:12px;margin-right:8px;font-weight:400}.dot[_ngcontent-%COMP%]{display:block;height:10px;width:10px;border-radius:50%;align-self:start;margin:16px 10px 16px 16px}.dot-unread[_ngcontent-%COMP%]{background:var(--ion-color-primary)}.dot-read[_ngcontent-%COMP%]{background:var(--ion-color-secondary)}.dot-active[_ngcontent-%COMP%]{background:var(--ion-color-success)}.small-font[_ngcontent-%COMP%]{font-size:12px}ion-footer[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-size:8px;font-weight:400}'],changeDetection:0}),a})();function J(n,a){if(1&n){const r=e.EpF();e.TgZ(0,"ion-item-sliding"),e._UZ(1,"app-evento-sae",7),e.TgZ(2,"ion-item-options",8)(3,"ion-item-option",9),e.NdJ("click",function(){const c=e.CHM(r).$implicit,l=e.oxw();return e.KtG(l.deleteItem(c.id))}),e._UZ(4,"ion-icon",10),e.qZA()()()}if(2&n){const r=a.$implicit;e.xp6(1),e.Q6J("eventosae",r)}}const z=[{path:"",component:(()=>{var n;class a{constructor(o,t,c,l,g,m,p,f,_){this.modalController=o,this.indexDBService=t,this.alertController=c,this.eventoSaeIndexdb=l,this.turnoSaeIndexdbService=g,this.navCtrl=m,this.sharedService=p,this.loadingCtrl=f,this.platform=_,this.eventos_sae=[],this.turnoSaeModel={},this.sharedService.eventosaeSelected$.subscribe(v=>{console.log("sharedService envio id : ",v),this.goToEventosaeDetail(v)}),this.sharedService.updateCargarEventos$.subscribe(()=>{console.log("sharedService.updateCargarEventos"),this.cargarEventos()})}ionViewWillLeave(){console.log("ionViewWillLeave")}ionViewDidLeave(){console.log("ionViewDidLeave")}ionViewDidEnter(){console.log("ionViewDidEnter")}ionViewWillEnter(){console.log("ionViewWillEnter")}ngOnInit(){console.log("ngOnInit tab2"),this.indexDBService.openDatabase().then(()=>this.cargarEventos()).catch(o=>{console.error("Error al inicializar la base de datos:",o)})}cargarEventos(){this.eventoSaeIndexdb.getAllEventoSae().then(o=>{this.eventos_sae=o,console.log("Eventos obtenidos:",o)}).catch(o=>{console.error("Error al obtener los eventos:",o)})}refresh(o){var t=this;return(0,d.Z)(function*(){setTimeout(()=>{o.detail.complete(),t.cargarEventos()},3e3)})()}goToEventosaeDetail(o){this.navCtrl.navigateForward("/eventosae/"+o)}ObtenerRegistrodeTurno(){var o=this;return(0,d.Z)(function*(){yield o.turnoSaeIndexdbService.getTurnosae(1).then(c=>{c?(o.turnoSaeModel.rut_maestro=c.rut_maestro,o.turnoSaeModel.rut_ayudante=c.rut_ayudante,o.turnoSaeModel.codigo_turno=c.codigo_turno,o.turnoSaeModel.codigo_oficina=c.codigo_oficina):console.log("No se encontr\xf3 el turno con ID 1")}).catch(c=>{console.error("Error al obtener el turno:",c)})})()}openNewEventoSaeForm(){var o=this;return(0,d.Z)(function*(){const t=yield o.modalController.create({component:T.a,cssClass:"new-eventosae-modal"});return t.onDidDismiss().then(function(){var c=(0,d.Z)(function*(l){if(l.data){const g=yield o.loadingCtrl.create({message:"Guardando..."});g.present();try{yield o.ObtenerRegistrodeTurno();const{numero_ot:m,direccion:p,requerimiento:f,tipo_evento:_,codigo_comuna:v,hora_inicio:U,hora_termino:Y}=l.data;yield o.obtenerUbicacion();const B=new P.k({numero_ot:m,tipo_evento:_,direccion:p,requerimiento:f,rut_maestro:o.turnoSaeModel.rut_maestro,rut_ayudante:o.turnoSaeModel.rut_ayudante,codigo_turno:o.turnoSaeModel.codigo_turno,codigo_oficina:o.turnoSaeModel.codigo_oficina,codigo_comuna:v,latitude:o.latitude,longitude:o.longitude,fecha_hora_ejecucion:new Date,hora_inicio:U,hora_termino:Y,estadoEnvio:0});o.eventoSaeIndexdb.guardarEventoSae(B),o.cargarEventos()}catch{}finally{g.dismiss()}}});return function(l){return c.apply(this,arguments)}}()),yield t.present()})()}deleteItem(o){console.log("ELIMINAR : ",o),this.confirmDelete(o)}confirmDelete(o){var t=this;return(0,d.Z)(function*(){yield(yield t.alertController.create({header:"Confirmar Eliminaci\xf3n",message:"\xbfEst\xe1s seguro de que deseas eliminar este elemento?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",handler:()=>{t.eventoSaeIndexdb.deleteEventoSae(o),t.cargarEventos()}}]})).present()})()}solicitarPermisosDeGeolocalizacion(){var o=this;return(0,d.Z)(function*(){if(o.platform.is("hybrid"))try{yield S.b.requestPermissions()}catch(t){console.error("Error al solicitar permisos de geolocalizaci\xf3n:",t)}else console.warn("La geolocalizaci\xf3n no est\xe1 disponible en la plataforma web.")})()}obtenerUbicacion(){var o=this;return(0,d.Z)(function*(){try{const t=yield S.b.getCurrentPosition();o.latitude=t.coords.latitude.toString(),o.longitude=t.coords.longitude.toString(),console.log("Ubicaci\xf3n obtenida:",t)}catch(t){console.error("Error al obtener la ubicaci\xf3n:",t)}})()}}return(n=a).\u0275fac=function(o){return new(o||n)(e.Y36(i.IN),e.Y36(y.p),e.Y36(i.Br),e.Y36(Z._),e.Y36(O.N),e.Y36(i.SH),e.Y36(E.F),e.Y36(i.HT),e.Y36(i.t4))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-tab2"]],decls:14,vars:3,consts:[[3,"translucent"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[4,"ngFor","ngForOf"],["vertical","bottom","horizontal","center","slot","fixed"],[3,"click"],["name","add"],[3,"eventosae"],["side","start"],["color","danger",3,"click"],["name","trash"]],template:function(o,t){1&o&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3," Bandeja de Eventos "),e.qZA()()(),e.TgZ(4,"ion-content",1)(5,"ion-refresher",2),e.NdJ("ionRefresh",function(l){return t.refresh(l)}),e._UZ(6,"ion-refresher-content"),e.qZA(),e.TgZ(7,"ion-card")(8,"ion-card-content")(9,"ion-list"),e.YNc(10,J,5,1,"ion-item-sliding",3),e.qZA()()(),e.TgZ(11,"ion-fab",4)(12,"ion-fab-button",5),e.NdJ("click",function(){return t.openNewEventoSaeForm()}),e._UZ(13,"ion-icon",6),e.qZA()()()),2&o&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(6),e.Q6J("ngForOf",t.eventos_sae))},dependencies:[i.PM,i.FN,i.W2,i.IJ,i.W4,i.Gu,i.gu,i.u8,i.IK,i.td,i.q_,i.nJ,i.Wo,i.wd,i.sr,u.sg,D]}),a})()}];let N=(()=>{var n;class a{}return(n=a).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[C.Bz.forChild(z),C.Bz]}),a})(),A=(()=>{var n;class a{}return(n=a).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[i.Pc,u.ez,h.u5,x,N,M]}),a})()}}]);